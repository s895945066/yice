(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-479c3139"],{"1b9e":function(t,a,r){},"2f21":function(t,a,r){"use strict";var i=r("79e5");t.exports=function(t,a){return!!t&&i(function(){a?t.call(null,function(){},1):t.call(null)})}},3583:function(t,a){t.exports="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMZaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkYxRDA3NDdDNEVDMDExRTk4NTNCQURDRjI1Q0IxNjcwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkYxRDA3NDdCNEVDMDExRTk4NTNCQURDRjI1Q0IxNjcwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSI5M0FCRjFFM0I1NURCMjRCNzg4NEU3MTgyOTIxRjA4NyIgc3RSZWY6ZG9jdW1lbnRJRD0iOTNBQkYxRTNCNTVEQjI0Qjc4ODRFNzE4MjkyMUYwODciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAM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"},"3f6e":function(t,a,r){"use strict";var i=r("1b9e"),e=r.n(i);e.a},"55dd":function(t,a,r){"use strict";var i=r("5ca1"),e=r("d8e8"),o=r("4bf8"),s=r("79e5"),n=[].sort,c=[1,2,3];i(i.P+i.F*(s(function(){c.sort(void 0)})||!s(function(){c.sort(null)})||!r("2f21")(n)),"Array",{sort:function(t){return void 0===t?n.call(o(this)):n.call(o(this),e(t))}})},"584a":function(t,a){var r=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=r)},"97fc":function(t,a,r){"use strict";var i=r("aebb"),e=r.n(i);e.a},a21f:function(t,a,r){var i=r("584a"),e=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return e.stringify.apply(e,arguments)}},aebb:function(t,a,r){},c4f4:function(t,a,r){"use strict";r.r(a);var i=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"main",attrs:{"element-loading-text":"正在为您下单，请耐心等待","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("m-header",{attrs:{title:"确认订单"}},[i("a",{attrs:{slot:"left",href:"javascript:;"},on:{click:t.goPrev},slot:"left"},[i("i",{staticClass:"el-icon-arrow-left"})])]),t.user_gain?i("div",{staticClass:"user_info"},[i("router-link",{attrs:{to:"/address_list"}},[i("img",{staticClass:"user_bar",attrs:{src:r("3583"),alt:"bar"}}),i("p",[i("span",[t._v(t._s(t.user_gain.gain_name))]),i("span",[t._v(t._s(t.user_gain.gain_phone))])]),i("p",{staticClass:"user_address"},[t._v(t._s(t.user_gain.gain_address+" "+t.user_gain.gain_addrdetail))]),i("i",{staticClass:"el-icon-arrow-right"})])],1):t._e(),t.confirm_data[0].pro_data&&t.confirm_data?i("div",{staticClass:"pro_list"},[i("h2",[t._v(t._s(t.pro_store))]),i("ul",t._l(t.confirm_data,function(a){return i("li",{key:a.pro_sign},[i("img",{attrs:{src:t._f("getAbspath")(a.pro_data.pro_img1),alt:""}}),i("div",{staticClass:"right"},[i("h3",[t._v(t._s(a.pro_data.pro_title))]),i("p",["1"==a.pro_pay?i("span",[t._v(t._s(a.pro_data.pro_coin)+" 积分")]):t._e(),"2"==a.pro_pay?i("span",[t._v("￥"+t._s(a.pro_data.pro_money))]):t._e(),"3"==a.pro_pay?i("span",[t._v("￥"+t._s(a.pro_data.pro_partmoney)+"+"+t._s(a.pro_data.pro_partcoin)+" 积分")]):t._e(),i("span",[t._v("x"+t._s(a.pro_count))])])])])}),0)]):t._e(),i("div",{staticClass:"user_remarks"},[i("p",[t._v("店铺备注")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.order_remark,expression:"order_remark"}],attrs:{type:"text",placeholder:"选填，给店家留言"},domProps:{value:t.order_remark},on:{input:function(a){a.target.composing||(t.order_remark=a.target.value)}}})]),t.confirm_data[0].pro_data&&t.confirm_data?i("div",{staticClass:"order_price"},[t.total[0]?i("div",{staticClass:"pro_total"},[i("span",[t._v("商品金额")]),i("span",[t._v("￥"+t._s(t.total[0]))])]):t._e(),t.total[1]?i("div",{staticClass:"pro_discount"},[i("span",[t._v("商品积分")]),i("span",[t._v(t._s(t.total[1])+" 积分")])]):t._e(),i("div",{staticClass:"order_total"},[i("span",[t._v("实付")]),i("span",[t._v(t._s(t.total[0]?"￥"+t.total[0]:"")+t._s(t.total[0]&&t.total[1]?"+":"")+t._s(t.total[1]?t.total[1]+" 积分":""))])])]):t._e(),t.confirm_data[0].pro_data&&t.confirm_data?i("div",{staticClass:"topay"},[i("el-button",{attrs:{type:"primary"},on:{click:t.goPay}},[t._v("立即支付")])],1):t._e()],1)},e=[],o=r("f499"),s=r.n(o),n=(r("55dd"),r("2b0e")),c=r("d784"),l={components:{mHeader:c["a"]},data:function(){return{isLoading:!1,pro_store:"i-testing",user_info:JSON.parse(localStorage.getItem("yice_user"))||null,user_gain:null,confirm_data:[],order_remark:"",order_id:""}},computed:{total:function(){for(var t=0,a=0,r=0;r<this.confirm_data.length;r++)"1"==this.confirm_data[r].pro_pay?t+=this.confirm_data[r].pro_data.pro_coin*this.confirm_data[r].pro_count:"2"==this.confirm_data[r].pro_pay?a+=this.confirm_data[r].pro_data.pro_money*this.confirm_data[r].pro_count:"3"==this.confirm_data[r].pro_pay&&(a+=this.confirm_data[r].pro_data.pro_partmoney*this.confirm_data[r].pro_count,t+=this.confirm_data[r].pro_data.pro_partcoin*this.confirm_data[r].pro_count);return[a,t]}},methods:{goPrev:function(){window.history.length>1?this.$router.back():this.$router.push("/")},delRepeat:function(t){t.sort();for(var a=[t[0]],r=1;r<t.length;r++)t[r]!==a[a.length-1]&&a.push(t[r]);return a},getConfirm:function(){if(sessionStorage.getItem("yice_comfirm"))this.confirm_data=JSON.parse(sessionStorage.getItem("yice_comfirm")),this.proInit();else{var t=this;this.$weui.alert("无法获取商品！请返回并重新购买商品",function(){t.$router.push("/")})}},proInit:function(){for(var t=this,a=[],r=0;r<t.confirm_data.length;r++)a.push(t.confirm_data[r].pro_id);var i=this.delRepeat(a);n["default"].axios.get("http://114.215.242.13:8010/api/yicemall/getPro",{params:{pro_arr:i}}).then(function(a){if(200==a.status)for(var r=0;r<t.confirm_data.length;r++)for(var i=0;i<a.data.length;i++)if(t.confirm_data[r].pro_id==a.data[i].pro_id){n["default"].set(t.confirm_data[r],"pro_data",a.data[i]);break}}).catch(function(t){alert(t)})},getGain:function(){var t=this;n["default"].axios.get("http://114.215.242.13:8010/api/yicemall/addressList",{params:{user_id:t.user_info.user_id}}).then(function(a){if(200==a.status)if(a.data.length){var r=a.data,i=t.$route.query.gain_id||r[0].gain_default||"";if(i)for(var e=0;e<r.length;e++)r[e].gain_id==i&&(t.user_gain=r[e]);else t.user_gain=r[0];t.getConfirm()}else t.$weui.alert("您还未添加地址，请添加地址",function(){t.$router.push("/alter_address?alter_type=0")})}).catch(function(t){alert(t)})},goPay:function(){var t=0;if(this.total[1]){if(this.user_info.user_coin&&this.user_info.user_coin>=this.total[1])t=1;else{var a=this;this.$weui.confirm("您的积分不足，前去赚取积分购物/使用现金购物",{title:"提示",buttons:[{label:"取消购物",type:"default",onClick:function(){window.history.length>1?a.$router.back():a.$router.push("/")}},{label:"去赚积分",type:"primary",onClick:function(){sessionStorage.removeItem("yice_comfirm"),a.$router.push("/user")}}]})}0==this.total[0]&&1==t&&(this.isLoading=!0,this.coinPay())}},coinPay:function(){for(var t=this,a=[this.user_info.user_id],r=0;r<this.confirm_data.length;r++)a.push(this.confirm_data[r].pro_sign);var i={user_id:this.user_info.user_id,user_coin:this.user_info.user_coin,coin_use:-this.total[1],coin_reason:"兑换实物",gain_id:this.user_gain.gain_id,order_status:"待发货",order_coin:this.total[1],order_money:this.total[0],order_remark:this.order_remark,order_pro:s()(this.confirm_data),del_arr:s()(a)};n["default"].axios({url:"http://114.215.242.13:8010/api/yicemall/comfirmOrder",method:"post",data:i,transformRequest:function(t){var a=[];for(var r in t)a.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return a.join("&")}}).then(function(a){if(200==a.status&&a.data.code){t.user_info.user_coin=a.data.user_coin,localStorage.setItem("yice_user",s()(t.user_info)),t.order_id=a.data.order_id;for(var r=JSON.parse(sessionStorage.getItem("yice_car")),i=0;i<t.confirm_data.length;i++)for(var e=0;e<r.length;e++)r[e].pro_sign==t.confirm_data[i].pro_sign&&(r.splice(e,1),sessionStorage.setItem("yice_car",s()(r)));sessionStorage.removeItem("yice_comfirm"),t.isLoading=!1,t.$router.push({path:"pay_success",query:{id:t.order_id}})}}).catch(function(a){alert(a),t.isLoading=!1})}},mounted:function(){this.user_info?this.getGain():this.$router.push("/login")}},d=l,u=(r("3f6e"),r("2877")),_=Object(u["a"])(d,i,e,!1,null,"eba5dde4",null);a["default"]=_.exports},d784:function(t,a,r){"use strict";var i=function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("header",{staticClass:"m-header is-fixed"},[r("div",{staticClass:"m-header-button is-left"},[t._t("left")],2),r("h1",{staticClass:"m-header-title",domProps:{textContent:t._s(t.title)}}),r("div",{staticClass:"m-header-button is-right"},[t._t("right")],2)])},e=[],o={props:{title:{type:String,default:""}}},s=o,n=(r("97fc"),r("2877")),c=Object(n["a"])(s,i,e,!1,null,"48061a4a",null);a["a"]=c.exports},f499:function(t,a,r){t.exports=r("a21f")}}]);