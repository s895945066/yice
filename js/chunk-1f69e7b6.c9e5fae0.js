(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f69e7b6"],{"584a":function(e,t){var r=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=r)},"97fc":function(e,t,r){"use strict";var a=r("aebb"),o=r.n(a);o.a},a21f:function(e,t,r){var a=r("584a"),o=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},aca2:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main"},[r("m-header",{attrs:{title:"发表评价"}},[r("a",{attrs:{slot:"left",href:"javascript:;"},on:{click:e.goPrev},slot:"left"},[r("i",{staticClass:"el-icon-arrow-left"})])]),e.order_pro.length?r("ul",{staticClass:"pro_comment"},e._l(e.order_pro,function(t){return r("li",{key:t.pro_sign},[r("div",{staticClass:"pro_rate"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.$options.filters.getAbspath(t.pro_img1),expression:"$options.filters.getAbspath(item.pro_img1)"}],attrs:{alt:""}}),r("div",{staticClass:"right"},[r("p",[e._v("描述相符")]),r("el-rate",{attrs:{"void-color":"#e5e8ed"},model:{value:t.pro_rate,callback:function(r){e.$set(t,"pro_rate",r)},expression:"item.pro_rate"}})],1)]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user_comment,expression:"item.user_comment"}],attrs:{rows:"4",placeholder:"宝贝满足你的期待吗？说说你的使用心得吧"},domProps:{value:t.user_comment},on:{input:function(r){r.target.composing||e.$set(t,"user_comment",r.target.value)}}})])}),0):e._e(),e.order_pro.length?r("ul",{staticClass:"store_comment"},[r("li",[r("p",[e._v("物流满意度")]),r("el-rate",{attrs:{"void-color":"#e5e8ed"},model:{value:e.mail_rate,callback:function(t){e.mail_rate=t},expression:"mail_rate"}})],1),r("li",[r("p",[e._v("服务满意度")]),r("el-rate",{attrs:{"void-color":"#e5e8ed"},model:{value:e.service_rate,callback:function(t){e.service_rate=t},expression:"service_rate"}})],1)]):e._e(),e.order_pro.length?r("button",{staticClass:"sub_btn",attrs:{type:"button"},on:{click:e.saveComment}},[e._v("提交")]):e._e()],1)},o=[],i=r("f499"),s=r.n(i),n=r("2b0e"),l=r("d784"),u={components:{mHeader:l["a"]},data:function(){return{user_info:JSON.parse(localStorage.getItem("yice_user"))||null,order_pro:[],mail_rate:0,service_rate:0,dialogImageUrl:"",dialogVisible:!1,isShow:!0,img_sum:0}},methods:{goPrev:function(){window.history.length>1?this.$router.back():this.$router.push("/")},loadOrder:function(){var e=this.$weui.loading("正在加载"),t=this;n["default"].axios.get("http://114.215.242.13:8010/api/yicemall/getOrderdetail",{params:{user_id:t.user_info.user_id,order_id:t.$route.query.id,is_comment:1}}).then(function(r){if(200==r.status){if(r.data.order_data)if("待评价"==r.data.order_data.order_status)for(var a=0;a<r.data.order_pro.length;a++)t.order_pro.push(r.data.order_pro[a]),t.$set(t.order_pro[a],"pro_rate",5),t.$set(t.order_pro[a],"user_comment",""),t.$set(t.order_pro[a],"imgFiles",[]),t.$set(t.order_pro[a],"imgMax",5);else t.$weui.alert("该订单不支持评价！",function(){t.$router.back()});else t.$weui.alert("无法获取订单信息，请返回并重试！",function(){t.$router.back()});e.hide()}}).catch(function(t){alert(t),e.hide()})},saveComment:function(){var e=this,t=[];if(0==e.mail_rate||0==e.service_rate)e.$weui.topTips("请给物流及服务评分");else{for(var r=0;r<e.order_pro.length;r++){var a=e.order_pro[r],o=e.user_info.user_name||e.user_info.wechat_name;t.push([a.order_id,a.pro_id,e.user_info.user_id,o,a.pro_rate,e.mail_rate,e.service_rate,a.user_comment])}n["default"].axios({url:"http://114.215.242.13:8010/api/yicemall/alertComment",method:"post",data:{order_id:e.$route.query.id,order_status:"已完成",comment_data:s()(t)},transformRequest:function(e){var t=[];for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}}).then(function(t){200==t.status&&t.data.code&&e.$weui.toast("评论成功",{duration:500,callback:function(){window.history.length>1?e.$router.back():e.$router.push("/")}})}).catch(function(t){alert(t),e.isLoading=!1})}}},mounted:function(){if(this.user_info)if(this.$route.query.id)this.loadOrder();else{var e=this;this.$weui.alert("无法获取订单信息，请返回并重试！",function(){e.$router.back()})}else this.$router.push("/login")}},c=u,d=(r("eb89"),r("2877")),_=Object(d["a"])(c,a,o,!1,null,"2f639e76",null);t["default"]=_.exports},aebb:function(e,t,r){},d784:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",{staticClass:"m-header is-fixed"},[r("div",{staticClass:"m-header-button is-left"},[e._t("left")],2),r("h1",{staticClass:"m-header-title",domProps:{textContent:e._s(e.title)}}),r("div",{staticClass:"m-header-button is-right"},[e._t("right")],2)])},o=[],i={props:{title:{type:String,default:""}}},s=i,n=(r("97fc"),r("2877")),l=Object(n["a"])(s,a,o,!1,null,"48061a4a",null);t["a"]=l.exports},eb89:function(e,t,r){"use strict";var a=r("f934"),o=r.n(a);o.a},f499:function(e,t,r){e.exports=r("a21f")},f934:function(e,t,r){}}]);